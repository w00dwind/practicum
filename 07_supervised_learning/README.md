# Прогнозирование оттока клиента Банка

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет.
* Метрика - F1-score, AUC-ROC

### Данные:
Датасет - Churn.csv
    Признаки:
        * CreditScore
        * Geography
        * Gender
        * Age
        * Tenure
        * Balance
        * NumOfProducts
        * HasCrCard
        * IsActiveMember
        * EstimatedSalary
        * Exited

### Ход исследования: 
* Предобработка данных - удалим пропуски, лишние признаки.
* Распределение целелвого признака ~80:20
* Для борьбы с дисбалансом классов использованы техники: 
    * Параметр class_weights='balanced' для логистической регрессии 
    * upsampling
    * Подбор порога вероятности классификатора
    
### Используемые инструменты:
Pandas, Matplotlib, Scikit-learn, CatBoost

### Выводы:

* Задача имеет существенный дисбаланс классов: ~80:20
* Наиболее устойчивой моделью с высокой метрикой F1 - можно считать Random forest. 
* F1 - усредненная метрика между precision и recall, однако в зависимости от задачи нам важно понимать: какая из двух метрик важнее. В нашем случае важнее recall. Т.к. лучше сделать спец предложение всем клиентам, которые могут уйти, пусть даже мы сделаем спец предложение нескольким клиентам, которые не собирались уходить из банка. Однако, если среди клиентов, отмеченных, как желающие уйти, будет слишком много обычных клиентов, не планировавших уходить, мы потратим много ресурсов впустую. 
* Техника upsampling дала прирост в случае с Логистической регрессией, но ухудшила результат случайного леса
* Изменение порога классов дало небольшой прирост в случае с Логистической регрессией и не изменила резульатат случайного леса.
* Catboost дал отличный результат на тренировочной выборке, однако сильно просел на тесте, несмотря на использование отложенной выборки для выбора наилучшей модели, что должно предотвратить переобучение. 